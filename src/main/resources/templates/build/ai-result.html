<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Build Result</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .result-container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px;
        }
        .result-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }
        .criteria-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .criteria-item {
            background: white;
            padding: 12px;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }
        .build-components {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .component-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        .component-item:last-child {
            border-bottom: none;
        }
        .component-label {
            font-weight: bold;
            color: #667eea;
            min-width: 150px;
        }
        .component-name {
            flex: 1;
            color: #333;
        }
        .component-price {
            font-weight: bold;
            color: #28a745;
            min-width: 150px;
            text-align: right;
        }
        .component-missing {
            color: #dc3545;
            font-style: italic;
        }
        .total-price {
            background: #28a745;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 30px;
        }
        .total-price .price {
            font-size: 36px;
            font-weight: bold;
        }
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5568d3;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div sec:authorize="hasRole('CUSTOMER')" th:replace="layout/header-customer :: header-customer"></div>
    <div sec:authorize="hasRole('STAFF')" th:replace="layout/header-staff :: header-staff"></div>
    <div sec:authorize="hasRole('ADMIN')" th:replace="layout/header-admin :: header-admin"></div>
    <div sec:authorize="isAnonymous()" th:replace="layout/header-guest :: header-guest"></div>

    <div class="result-container">
        <!-- Header -->
        <div class="result-header">
            <h2>ü§ñ C·∫•u h√¨nh PC ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t</h2>
            <p th:text="'Y√™u c·∫ßu: ' + ${request.requirement}"></p>
        </div>

        <!-- AI Criteria -->
        <div class="criteria-box">
            <h3>üìä Ti√™u ch√≠ ph√¢n t√≠ch</h3>
            <div class="criteria-grid">
                <div class="criteria-item" th:if="${criteria.useCase}">
                    <strong>M·ª•c ƒë√≠ch:</strong>
                    <span th:text="${criteria.useCase}"></span>
                </div>
                <div class="criteria-item" th:if="${criteria.gpuPerformanceLevel}">
                    <strong>GPU Level:</strong>
                    <span th:text="${criteria.gpuPerformanceLevel}"></span>
                </div>
                <div class="criteria-item" th:if="${criteria.cpuPerformanceLevel}">
                    <strong>CPU Level:</strong>
                    <span th:text="${criteria.cpuPerformanceLevel}"></span>
                </div>
                <div class="criteria-item" th:if="${criteria.minRamCapacity}">
                    <strong>RAM:</strong>
                    <span th:text="${criteria.minRamCapacity} + ' GB'"></span>
                </div>
                <div class="criteria-item" th:if="${criteria.minStorageCapacity}">
                    <strong>Storage:</strong>
                    <span th:text="${criteria.minStorageCapacity} + ' GB'"></span>
                </div>
            </div>
        </div>

        <!-- Warning if incomplete -->
        <div class="warning-box" th:if="${build.cpu == null or build.gpu == null}">
            <strong>‚ö†Ô∏è L∆∞u √Ω:</strong>
            M·ªôt s·ªë linh ki·ªán ch∆∞a ƒë∆∞·ª£c ch·ªçn. C√≥ th·ªÉ do database ch∆∞a c√≥ s·∫£n ph·∫©m ph√π h·ª£p.
        </div>

        <!-- Build Components -->
        <div class="build-components">
            <h3>üñ•Ô∏è C·∫•u h√¨nh ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t</h3>

            <div class="component-item">
                <span class="component-label">CPU:</span>
                <span class="component-name" th:if="${build.cpu}" th:text="${build.cpu.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.cpu}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.cpu}"
                      th:text="${#numbers.formatDecimal(build.cpu.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">GPU:</span>
                <span class="component-name" th:if="${build.gpu}" th:text="${build.gpu.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.gpu}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.gpu}"
                      th:text="${#numbers.formatDecimal(build.gpu.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Mainboard:</span>
                <span class="component-name" th:if="${build.mainboard}" th:text="${build.mainboard.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.mainboard}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.mainboard}"
                      th:text="${#numbers.formatDecimal(build.mainboard.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Memory (RAM):</span>
                <span class="component-name" th:if="${build.memory}" th:text="${build.memory.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.memory}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.memory}"
                      th:text="${#numbers.formatDecimal(build.memory.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Storage:</span>
                <span class="component-name" th:if="${build.storage}" th:text="${build.storage.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.storage}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.storage}"
                      th:text="${#numbers.formatDecimal(build.storage.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Power Supply:</span>
                <span class="component-name" th:if="${build.powerSupply}" th:text="${build.powerSupply.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.powerSupply}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.powerSupply}"
                      th:text="${#numbers.formatDecimal(build.powerSupply.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Cooling:</span>
                <span class="component-name" th:if="${build.cooling}" th:text="${build.cooling.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.cooling}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.cooling}"
                      th:text="${#numbers.formatDecimal(build.cooling.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>

            <div class="component-item">
                <span class="component-label">Case:</span>
                <span class="component-name" th:if="${build.pcCase}" th:text="${build.pcCase.product.name}"></span>
                <span class="component-name component-missing" th:unless="${build.pcCase}">Ch∆∞a ch·ªçn</span>
                <span class="component-price" th:if="${build.pcCase}"
                      th:text="${#numbers.formatDecimal(build.pcCase.product.price, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></span>
            </div>
        </div>

        <!-- Total Price -->
        <div class="total-price">
            <h3>üí∞ T·ªïng gi√° tr·ªã:</h3>
            <div class="price" th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></div>
            <p th:if="${request.budget}"
               th:text="'(Ng√¢n s√°ch: ' + ${#numbers.formatDecimal(request.budget * 1000000, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´)'"></p>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <form th:action="@{/build/ai/accept}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-primary">
                    ‚úÖ Ch·∫•p nh·∫≠n c·∫•u h√¨nh n√†y
                </button>
            </form>
            <a th:href="@{/build/ai/suggest}" class="btn btn-secondary">
                üîÑ Th·ª≠ l·∫°i
            </a>
        </div>
    </div>

    <!-- Footer -->
    <div th:replace="layout/footer :: footer"></div>
</body>
</html>

